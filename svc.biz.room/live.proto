syntax = "proto3";

package svc.biz.room;

import "google/protobuf/field_mask.proto";
import "google/protobuf/timestamp.proto";
import "google/protobuf/empty.proto";

option go_package="./svc.biz.room;room";

// 房间
service Live {
    // 开始直播
    rpc StartLive(StartLiveReq) returns(StartLiveResp);
    // 关闭直播
    rpc StopLive(StopLiveReq) returns(StopLiveResp);
    // 更新直播
    rpc UpdateLive(UpdateLiveReq) returns(google.protobuf.Empty);
    // 查询直播间信息
    rpc GetLiveInfo(GetLiveInfoReq) returns(GetLiveInfoResp);
    // 批量获取直播间信息
    rpc MGetLiveInfo(MGetLiveInfoReq) returns(MGetLiveInfoResp);
    // 获取在播直播间列表
    rpc OnlineLiveList(OnlineLiveListReq) returns (OnlineLiveListResp);
}

enum LiveDisplayType {
    LiveDisplayTypeUnknown = 0; // 未知
    LiveDisplayTypeHorizontal = 1; // 横屏
    LiveDisplayTypeVertical = 2; // 竖屏
}

enum LiveStatus {
    LiveStatusUnknown = 0; // 未知
    LiveStatusOnline = 1; // 上线
    LiveStatusOffline = 2; // 下线
}

message StartLiveReq {
    string streamer_id = 1; // 主播id
    LiveDisplayType display_type = 2; // 横竖屏类型
}
message StartLiveResp {
    string live_id = 1; // 直播id
}

message StopLiveReq {
    string streamer_id = 1; // 主播id
}
message StopLiveResp {

}

message UpdateLiveReq {
    string live_id = 1; // 直播id
    LiveInfo live = 2; // 直播信息
    google.protobuf.FieldMask update_mask = 3;
}

message GetLiveInfoReq {
    string live_id = 1; // 直播id
}
message GetLiveInfoResp {
    LiveInfo live = 1; // 直播信息
}

message MGetLiveInfoReq {
    repeated string live_ids = 1; // 直播id列表
}
message MGetLiveInfoResp {
    map<string, LiveInfo> items = 1; // 直播信息
}

message OnlineLiveListReq {
    int32 page = 1; // 页数
    int32 limit = 2; // 条数
    string category_id = 3; // 分类id
}
message OnlineLiveListResp {
    repeated LiveInfo items = 1; // 直播信息
}


message LiveInfo {
    string id = 1; // id
    string streamer_id = 2; // 主播id
    string category_id = 3; // 分类id
    LiveStatus status = 4; // 状态：1表示开播，2表示关播
    LiveDisplayType display_type = 5; // 横竖屏类型
    google.protobuf.Timestamp start_at = 6; // 开播时间
    google.protobuf.Timestamp end_at = 7; // 结束时间
    int32 score_recommend = 101; // 推荐分数
    int32 score_search = 102; // 搜索分数
    int32 score_subscribe = 103; // 关注分数
    int32 score_hot = 104; // 热度分数
    int32 score_glamour = 105; // 魅力分数
    int32 score_online = 106; // 在线人数
    int32 score_gift = 107; // 礼物分数
    google.protobuf.Timestamp created_at = 255; // 创建时间
    google.protobuf.Timestamp updated_at = 256; // 更新时间
}